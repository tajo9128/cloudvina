services:
  - type: web
    name: cloudvina-api
    env: python
    region: oregon
    plan: free
    buildCommand: chmod +x build.sh && ./build.sh
    startCommand: gunicorn main:app -k uvicorn.workers.UvicornWorker -w 4 -b 0.0.0.0:$PORT --timeout 120 --log-level info --access-logfile - --error-logfile - --capture-output --enable-stdio-inheritance
    envVars:
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_KEY
        sync: false
      - key: AWS_ACCESS_KEY_ID
        sync: false
      - key: AWS_SECRET_ACCESS_KEY
        sync: false
      - key: AWS_REGION
        value: us-east-1
      - key: S3_BUCKET
        value: cloudvina-jobs-use1-1763775915
      - key: BATCH_JOB_QUEUE
        value: cloudvina-fargate-queue
      - key: BATCH_JOB_DEFINITION
        value: cloudvina-job
      - key: PYTHONUNBUFFERED
        value: "1"
      - key: GEMINI_API_KEY
        sync: false
